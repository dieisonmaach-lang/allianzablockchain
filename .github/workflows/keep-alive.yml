name: Keep-Alive Allianza Testnet

on:
  schedule:
    # Executa a cada 10 minutos (mais frequente para evitar sleep)
    - cron: '*/10 * * * *'
  workflow_dispatch:  # Permite execu√ß√£o manual
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  keep-alive:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    steps:
      - name: Checkout (n√£o necess√°rio, mas mant√©m workflow ativo)
        uses: actions/checkout@v6
      
      - name: Ping Testnet
        run: |
          echo "üîÑ Enviando ping para Allianza Testnet..."
          response=$(curl -s -o /dev/null -w "%{http_code}" --max-time 10 https://testnet.allianza.tech/health)
          if [ "$response" = "200" ]; then
            echo "‚úÖ Ping bem-sucedido! Status: 200"
            exit 0
          else
            echo "‚ö†Ô∏è  Ping retornou status: $response"
            # N√£o falhar o workflow mesmo se o ping falhar
            exit 0
          fi
      
      - name: Verificar se Render est√° ativo
        run: |
          echo "üîç Verificando status do Render..."
          curl -s -o /dev/null -w "Status: %{http_code}\n" --max-time 10 https://testnet.allianza.tech/ || echo "‚ö†Ô∏è  Render pode estar em sleep mode"

